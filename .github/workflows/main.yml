name: TITAN-V187-50-CHANNELS-AI-PRO

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: windows-latest
    steps:
      - name: 1. Deep System Optimization
        shell: powershell
        run: |
          Stop-Service -Name wuauserv, SysMain -Force
          choco install cloudflare-warp -y
          pip install google-generativeai google-auth google-auth-oauthlib google-api-python-client pandas --quiet
          winget install --id Mozilla.Firefox -e --silent --accept-source-agreements

      - name: 2. Initial Connection
        shell: powershell
        run: |
          $tsUrl = "https://pkgs.tailscale.com/stable/tailscale-setup-1.82.0-amd64.msi"
          Invoke-WebRequest -Uri $tsUrl -OutFile "ts.msi"
          Start-Process msiexec.exe -ArgumentList "/i", "ts.msi", "/quiet", "/norestart" -Wait
          & "$env:ProgramFiles\Tailscale\tailscale.exe" up --accept-dns=false --force-reauth
          Start-Sleep -Seconds 30
          & "C:\Program Files\Cloudflare\Cloudflare WARP\warp-cli.exe" --accept-tos registration register
          & "C:\Program Files\Cloudflare\Cloudflare WARP\warp-cli.exe" --accept-tos connect

      - name: 3. Deploy AI-PRO Channel Creator
        run: |
          $script = @"
          import os, time, random, csv
          import google.generativeai as genai
          from google_auth_oauthlib.flow import InstalledAppFlow
          from googleapiclient.discovery import build

          # API KEYS
          GEMINI_KEY = "AIzaSyBs3-vbv7XF_8uCGcKRjQxEQVBCVYCh1G0"
          YT_CLIENT_ID = "73026014910-1ui7eu29pqcclsmaf435ad8frm7clkr0.apps.googleusercontent.com"
          YT_CLIENT_SECRET = "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"
          LOG_FILE = r"C:\Users\Public\Desktop\AI_Channel_Pro_Report.csv"

          genai.configure(api_key=GEMINI_KEY)
          gem_model = genai.GenerativeModel('gemini-pro')

          def get_ai_creative_data():
              # Feature: Smart AI Niche & Content
              prompt = "Think of a unique YouTube niche. Give me a creative Channel Name and a professional 30-word 'About' section including 3 SEO tags. Format: Name | About"
              try:
                  response = gem_model.generate_content(prompt)
                  parts = response.text.split('|')
                  return parts[0].strip(), parts[1].strip()
              except:
                  return f"Titan Global {random.randint(100,999)}", "Advanced automated content hub."

          def rotate_ip():
              # Feature: IP Rotation via Warp
              print("[!] Rotating IP for safety...")
              os.system('\"C:\\Program Files\\Cloudflare\\Cloudflare WARP\\warp-cli.exe\" disconnect')
              time.sleep(10)
              os.system('\"C:\\Program Files\\Cloudflare\\Cloudflare WARP\\warp-cli.exe\" connect')
              time.sleep(15)

          def main():
              print("--- TITAN AI-PRO FACTORY STARTING ---")
              flow = InstalledAppFlow.from_client_config(
                  {"installed": {"client_id": YT_CLIENT_ID, "client_secret": YT_CLIENT_SECRET, "auth_uri": "https://accounts.google.com/o/oauth2/auth", "token_uri": "https://oauth2.googleapis.com/token"}},
                  ['https://www.googleapis.com/auth/youtube.force-ssl'])
              
              credentials = flow.run_local_server(port=0)
              youtube = build('youtube', 'v3', credentials=credentials)

              with open(LOG_FILE, mode='a', newline='', encoding='utf-8') as file:
                  writer = csv.writer(file)
                  if os.stat(LOG_FILE).st_size == 0:
                      writer.writerow(["Channel Name", "AI Description", "Status", "Time"])

                  for i in range(50):
                      if i > 0 and i % 10 == 0:
                          rotate_ip() # Feature: IP Rotation every 10 channels

                      name, about = get_ai_creative_data()
                      try:
                          # Feature: SEO Integrated Creation
                          youtube.channels().insert(
                              part="snippet", 
                              body={"snippet": {"title": name, "description": about}}
                          ).execute()
                          
                          print(f"[+] Success {i+1}/50: {name}")
                          writer.writerow([name, about, "Created", time.ctime()])
                      except Exception as e:
                          print(f"[-] Error at {name}: {e}")
                          writer.writerow([name, about, f"Error: {e}", time.ctime()])
                      
                      # Feature: Human-Like Delay
                      delay = random.randint(60, 150)
                      print(f"Waiting {delay}s for Google safety...")
                      time.sleep(delay)

          if __name__ == "__main__":
              main()
          "@
          $script | Out-File -FilePath "C:\Users\Public\Desktop\AI_FACTORY_PRO.py" -Encoding ascii
          "@echo off`ntitle TITAN AI-PRO FACTORY`npython C:\Users\Public\Desktop\AI_FACTORY_PRO.py`npause" | Out-File -FilePath "C:\Users\Public\Desktop\START_PRO_CREATOR.bat" -Encoding ascii

      - name: 4. Keep-Alive
        run: Start-Sleep -Seconds 32400
