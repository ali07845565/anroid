name: TITAN-V209-PROXY-WATCHTIME-PRO

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: windows-latest
    steps:
      - name: 1. Setup User & Mobile View (800x600)
        run: |
          $Password = ConvertTo-SecureString "Admin@Watch786" -AsPlainText -Force
          net user RDP Admin@Watch786 /add /expires:never
          net localgroup Administrators RDP /add
          # Mobile optimization: Touch-friendly resolution
          Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp' -Name "DefaultDestinationHeight" -Value 600
          Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp' -Name "DefaultDestinationWidth" -Value 800
          net start audiosrv

      - name: 2. Install Pro Tools & Epic Bot
        run: |
          choco install googlechrome cloudflared python vcredist140 -y --no-progress
          pip install pyautogui requests --quiet
          # Downloading Epic Bot Pro Setup
          Invoke-WebRequest -Uri "https://cdn.epicbot.com/EpicBotSetup.exe" -OutFile "C:\Users\Public\Desktop\EpicBot_Pro_Setup.exe"

      - name: 3. Deploy 50-Proxy Rotation Script
        shell: powershell
        run: |
          $proxyScript = @"
          import requests
          def get_proxies():
              # 50+ Fresh proxies fetch karne ka logic
              url = "https://api.proxyscrape.com/v2/?request=displayproxies&protocol=http&timeout=10000&country=all&ssl=all&anonymity=all"
              r = requests.get(url)
              with open("C:\\Users\\Public\\Desktop\\Proxies.txt", "w") as f:
                  f.write(r.text)
              print("50+ Fresh Proxies Saved to Desktop!")

          if __name__ == "__main__":
              get_proxies()
          "@
          $proxyScript | Out-File -FilePath "C:\Users\Public\Desktop\Get_Proxies.py" -Encoding ascii
          python C:\Users\Public\Desktop\Get_Proxies.py

      - name: 4. Generate Direct Mobile Link
        shell: powershell
        run: |
          Write-Host "--- COPY THIS LINK FOR MOBILE RDP ---" -ForegroundColor Cyan
          Start-Process cloudflared -ArgumentList "tunnel --url rdp://localhost:3389" -RedirectStandardOutput "C:\Users\Public\Desktop\address.log"
          Start-Sleep -Seconds 30
          Get-Content "C:\Users\Public\Desktop\address.log" | Select-String "trycloudflare.com"

      - name: 5. Anti-Sleep & Human-Touch Bot
        run: |
          $bot = @"
          import pyautogui, time, random
          while True:
              pyautogui.press('shift')
              pyautogui.moveRel(random.randint(-10,10), random.randint(-10,10))
              time.sleep(20) # Screen hamesha active rahegi
          "@
          $bot | Out-File -FilePath "C:\Users\Public\Desktop\TITAN_ACTIVE.py" -Encoding ascii
          Start-Process python -ArgumentList "C:\Users\Public\Desktop\TITAN_ACTIVE.py"

      - name: 6. 9-Hour Non-Stop Power
        run: Start-Sleep -Seconds 32400
